
<!-- saved from url=(0045)https://rise4fun.com/z3/tutorialcontent/guide -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" charset="UTF-8" src="./Z3 - Guide_files/widget.aspx"></script>
    <title id="pageTitle">Z3 - Guide</title>    
    <meta name="description" content="Z3 - Guide">    
    <link rel="stylesheet" type="text/css" href="./Z3 - Guide_files/mscc-0.3.6.min.css">
    <link rel="stylesheet" href="./Z3 - Guide_files/Site.min.css" type="text/css">
    <link rel="stylesheet" href="./Z3 - Guide_files/coursecontent.min.css" type="text/css">
    
    <meta http-equiv="X-UA-Compatible" content="IE=9">
    <!--Mobile --> 
    <link rel="stylesheet" type="text/css" href="./Z3 - Guide_files/antiscreen.min.css" media="handheld, only screen and (max-device-width:480px)">	
    <!--[if IEMobile 7]> 
    <link rel="stylesheet" type="text/css" href="/Styles/antiscreen.min.css?hash=636628142235604434" media="screen"/>	
    <![endif]-->
    <script src="./Z3 - Guide_files/jquery-1.7.min.js" type="text/jscript"></script>
    
	<link rel="stylesheet" type="text/css" media="screen" href="./Z3 - Guide_files/editor.main.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./Z3 - Guide_files/vs-theme.css">
    <link rel="stylesheet" type="text/css" href="./Z3 - Guide_files/editor.main(1).css"><link rel="stylesheet" type="text/css" media="screen" href="./Z3 - Guide_files/monarch.min.css">
    <script type="text/javascript" src="./Z3 - Guide_files/loader.js"></script>
    <script type="text/javascript" src="./Z3 - Guide_files/courseeditorearly.js"></script>
    <style type="text/css">
    pre.listingeditor    
    {
        background-color:#f8f8f8;
        white-space:normal;
        height:auto;
        border:2 none gray;
    }
    </style>

    <script type="text/jscript">
        $(document).ready(function () {
            var h1 = $('h1');
            var h2s = $('h2');
            if (h1 != null && h2s != null) {
                var tocHtml = '<div class="toc"><ol class="toc">';
                h2s.each(function (i, h2) {
                    var id = 'h2' + i;
                    h2.id = id;
                    tocHtml += '<li><a href="#' + id + '">' + h2.innerText + '</a></li>';
                });
                tocHtml += '</ol></div><div class="clear" />';
                h1.after(tocHtml);

            }

            var lang = 
{
  displayName:    'SMT 2.0',
  name:           'smt2',
  mimeTypes:      ['text/x-smt2'],
  fileExtensions: ['.smt2'],
  
  lineComments:      [';'],   
 
  
  

  keywords: [
    'define-fun', 'define-const', 'assert', 'push', 'pop', 'assert', 'check-sat', 
    'declare-const', 'declare-fun', 'get-model', 'get-value', 'declare-sort', 
    'declare-datatypes', 'reset', 'eval', 'set-logic', 'help', 'get-assignment',
    'exit', 'get-proof', 'get-unsat-core', 'echo', 'let', 'forall', 'exists',
    'define-sort', 'set-option', 'get-option', 'set-info', 'check-sat-using', 'apply', 'simplify', 'elim-quantifiers', 
    'display', 'as', '!', 'get-info', 'declare-map', 'declare-rel', 'declare-var', 'rule',
    'query', 'get-user-tactics', 'minimize', 'maximize', 'assert-soft'
  ],

 operators: [
    '=', '>', '<', '<=', '>=', '=>', '+', '-', '*', '/',
  ], 
    
  builtins: [    
    'mod', 'div', 'rem', '^', 'to_real', 'and', 'or', 'not', 'distinct',   
    'to_int', 'is_int', '~', 'xor', 'if', 'ite', 'true', 'false', 'root-obj', 
    'sat', 'unsat', 'const', 'map', 'store', 'select', 'sat', 'unsat',
    'bit1', 'bit0', 'bvneg', 'bvadd', 'bvsub', 'bvmul', 'bvsdiv', 'bvudiv', 'bvsrem', 
    'bvurem', 'bvsmod',  'bvule', 'bvsle', 'bvuge', 'bvsge', 'bvult', 
    'bvslt', 'bvugt', 'bvsgt', 'bvand', 'bvor', 'bvnot', 'bvxor', 'bvnand', 
    'bvnor', 'bvxnor', 'concat', 'sign_extend', 'zero_extend', 'extract', 
    'repeat', 'bvredor', 'bvredand', 'bvcomp', 'bvshl', 'bvlshr', 'bvashr', 
    'rotate_left', 'rotate_right', 'get-assertions'
  ],
   
  brackets: [
    ['(',')','delimiter.parenthesis'],
    ['{','}','delimiter.curly'],
    ['[',']','delimiter.square']
  ],
  
  
  symbols:  '[=><~&|+\\-*\\/%@#]+',
  
  
  escapes: '\\\\(?:[abfnrtv\\\\"\']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})',
  
  
  tokenizer: {
    root: [
      
      ['[a-z_][\\w\\-\\.\']*', { cases: { '@builtins': 'predefined.identifier',
                                      '@keywords': 'keyword',
                                      '@default': 'identifier' } }],
      ['[A-Z][\\w\\-\\.\']*', 'type.identifier' ],
      ['[:][\\w\\-\\.\']*', 'string.identifier' ],
      ['[$?][\\w\\-\\.\']*', 'constructor.identifier' ],
      
      
      { include: '@whitespace' },
      
      
      ['[()\\[\\]]', '@brackets'],
      ['@symbols', { cases: { '@operators': 'predefined.operator', 
                              '@default'  : 'operator' } } ],

      
      
      ['\\d*\\.\\d+([eE][\\-+]?\\d+)?', 'number.float'],
      ['0[xX][0-9a-fA-F]+', 'number.hex'],
      ['#[xX][0-9a-fA-F]+', 'number.hex'],
      ['#b[0-1]+', 'number.binary'],
      ['\\d+', 'number'],

      
      ['[,.]', 'delimiter'],
      
      
      ['"([^"\\\\]|\\\\.)*$', 'string.invalid' ],  
      ['"',  { token: 'string.quote', bracket: '@open', next: '@string' } ],
      
      
      ['\\{', { token: 'string.curly', bracket: '@open', next: '@uservalue' } ],
    ],

    uservalue: [
      ['[^\\\\\\}]+', 'string' ],
      ['\\}',       { token: 'string.curly', bracket: '@close', next: '@pop' } ],
      ['\\\\\\}',     'string.escape'],
      ['.',        'string']  
    ],

    string: [
      ['[^\\\\"]+',  'string'],
      ['@escapes', 'string.escape'],
      ['\\\\.',      'string.escape.invalid'],
      ['"',        { token: 'string.quote', bracket: '@close', next: '@pop' } ]
    ],
    
    whitespace: [
      ['[ \\t\\r\\n]+', 'white'],
      [';.*$',    'comment'],
    ],
  },
}
;
            loadEditors('text/x-smt2', lang);


        });
    </script>
 <script async="async" type="text/javascript" src="./Z3 - Guide_files/editor.main.js"></script><script async="async" type="text/javascript" src="./Z3 - Guide_files/editor.main.nls.js"></script><script type="text/javascript" charset="utf-8" src="./Z3 - Guide_files/metrics.js"></script><style type="text/css"></style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuTitle {background-color: #CCCCCC; margin: -5px 0 0 0; text-align: center; font-style: italic; font-size: 80%; color: #444444; padding: 2px 0; overflow: hidden}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script async="async" type="text/javascript" src="./Z3 - Guide_files/monarch.js"></script><script async="async" type="text/javascript" src="./Z3 - Guide_files/monarchCommon.js"></script><script async="async" type="text/javascript" src="./Z3 - Guide_files/monarchCompile.js"></script></head>
<body><div id="MathJax_Message" style="display: none;"></div>   <div id="msccBanner" dir="ltr" data-site-name="uhf-codehunt" data-mscc-version="0.3.6" data-nver="aspnet-2.0.5" data-sver="0.1.2" class="cc-banner active" role="alert"><div class="cc-container"><svg class="cc-icon cc-v-center" x="0px" y="0px" viewBox="0 0 44 44" height="30px" fill="none" stroke="currentColor"><circle cx="22" cy="22" r="20" stroke-width="2"></circle><line x1="22" x2="22" y1="18" y2="33" stroke-width="3"></line><line x1="22" x2="22" y1="12" y2="15" stroke-width="3"></line></svg> <span class="cc-v-center cc-text">This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> <a href="https://go.microsoft.com/fwlink/?linkid=845480" aria-label="Learn more about Microsoft’s Cookie Policy" id="msccLearnMore" class="cc-link cc-v-center cc-float-right" data-mscc-ic="false">Learn more</a></div></div>
    
    <div id="MicrosoftTranslatorWidget" style="border: 2px solid rgb(64, 64, 64); direction: ltr; width: 200px; min-height: 57px; background-color: rgb(160, 160, 160); float: right; background-repeat: repeat-x; background-image: url(&quot;data:image/x-ms-bmp;base64,Qk2eAAAAAAAAADYAAAAoAAAAAQAAABoAAAABABgAAAAAAGgAAAAAAAAAAAAAAAAAAAAAAAAAcHBw/2xsbP9paWn/ZWVl/2FhYf9eXl7/Wlpa/1ZWVv9SUlL/T09P/0tLS/9HR0f/RERE/3BwcP90dHT/d3d3/3t7e/9/f3//goKC/4aGhv+Kior/jo6O/5GRkf+VlZX/mZmZ/5ycnP8=&quot;);" class="" translate="no"><div id="MSTWContent"><div id="MSTWHeader" style="border-color: rgb(131, 131, 131);"><span class="MSTWBox"><span id="MSTWHeaderText" style="width: 160px;">Translate this page</span></span><span class="MSTWBox"><select name="MSTWMenu" id="MSTWMenu" style="margin-top: 2px;"><option value="af">Afrikaans</option><option value="ar">Arabic</option><option value="bn">Bangla</option><option value="bs-latn">Bosnian (Latin)</option><option value="bg">Bulgarian</option><option value="yue">Cantonese (Traditional)</option><option value="ca">Catalan</option><option value="zh-chs">Chinese Simplified</option><option value="zh-cht">Chinese Traditional</option><option value="hr">Croatian</option><option value="cs">Czech</option><option value="da">Danish</option><option value="nl">Dutch</option><option value="et">Estonian</option><option value="fj">Fijian</option><option value="fil">Filipino</option><option value="fi">Finnish</option><option value="fr">French</option><option value="de">German</option><option value="el">Greek</option><option value="ht">Haitian Creole</option><option value="he">Hebrew</option><option value="hi">Hindi</option><option value="mww">Hmong Daw</option><option value="hu">Hungarian</option><option value="is">Icelandic</option><option value="id">Indonesian</option><option value="it">Italian</option><option value="ja">Japanese</option><option value="sw">Kiswahili</option><option value="tlh">Klingon</option><option value="ko">Korean</option><option value="lv">Latvian</option><option value="lt">Lithuanian</option><option value="mg">Malagasy</option><option value="ms">Malay</option><option value="mt">Maltese</option><option value="no">Norwegian Bokmål</option><option value="fa">Persian</option><option value="pl">Polish</option><option value="pt">Portuguese</option><option value="otq">Querétaro Otomi</option><option value="ro">Romanian</option><option value="ru">Russian</option><option value="sm">Samoan</option><option value="sr-cyrl">Serbian (Cyrillic)</option><option value="sr-latn">Serbian (Latin)</option><option value="sk">Slovak</option><option value="sl">Slovenian</option><option selected="selected" value="es">Spanish</option><option value="sv">Swedish</option><option value="ty">Tahitian</option><option value="ta">Tamil</option><option value="te">Telugu</option><option value="th">Thai</option><option value="to">Tongan</option><option value="tr">Turkish</option><option value="uk">Ukrainian</option><option value="ur">Urdu</option><option value="vi">Vietnamese</option><option value="cy">Welsh</option><option value="yua">Yucatec Maya</option></select><a id="MSTWGoButton" title="Translate this page" class="MSTWButtonLink" href="javascript: Translate this page" style="overflow: hidden; background-repeat: repeat-x; background-image: url(&quot;data:image/x-ms-bmp;base64,Qk2GAAAAAAAAADYAAAAoAAAAAQAAABQAAAABABgAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAuLi4/7a2tv+zs7P/sbGx/66urv+srKz/qqqq/6enp/+lpaX/oqKi/7i4uP+6urr/vb29/7+/v//CwsL/xMTE/8bGxv/Jycn/y8vL/87Ozv8=&quot;); border-color: rgb(131, 131, 131);"><img id="MSTWGoImage" src="data:image/gif;base64,R0lGODlhGAASAHAAACH5BAEAAP8ALAAAAAAYABIAhwAAAP%2f%2f%2fwAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAg8AP8JHEiwoMGDCBMqXMiwIcMAARwihAhRYkGKFC0KxIjRIkeODj9%2bfCiyYsOSHkFq7KhxY8SW%0d%0aMGPKRBgQADs%3d" style="border-width:0px;"></a></span></div><div id="MSTWFooter"><span id="MSTWBrand" class="MSTWBox"><a id="MSTWBrandLink" title="Microsoft® Translator" href="http://www.bing.com/translator?ref=MSTWidget" target="_blank"><span style="font-family: Segoe UI; direction: ltr;">Microsoft<sup style="vertical-align: super; font-size: 70%;">®</sup> Translator</span></a></span><span id="MSTWGetShare" class="MSTWBox"><a id="MSTWGetButton" title="Get this widget for your own site" class="MSTWButtonLink" href="http://www.bing.com/widget/translator" target="_blank" style="border-color: rgb(131, 131, 131);"><img id="MSTWGetImage" src="data:image/gif;base64,R0lGODlhGAASAPcAAAAAAP%2f%2f%2fwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAYABIA%0d%0aAAhBAP8JHEiwoMGDCBMqXMiwocOHCAMEGCgRYkWCFxlmxDhx4caCH0F2TBiSI8mRJw%2bWVIny38qI%0d%0aI19CnEmzpk2DAQEAOw%3d%3d" style="border-width:0px;"></a><a id="MSTWShareButton" title="Share" class="MSTWButtonLink" href="mailto:?charset=utf-8&amp;subject=Check%20out%20this%20page%20in%20Spanish%20translated%20from%20English&amp;body=Translated%3A%20https%3A%2F%2Frise4fun.com%2Fz3%2Ftutorialcontent%2Fguide%23mstto%3Des%0D%0AOriginal%3A%20https%3A%2F%2Frise4fun.com%2Fz3%2Ftutorialcontent%2Fguide%0D%0A%0D%0AAutomatic%20translation%20powered%20by%20Microsoft%C2%AE%20Translator%0D%0Ahttp%3A%2F%2Fwww.bing.com%2Ftranslator" style="border-color: rgb(131, 131, 131);"><img id="MSTWShareImage" src="data:image/gif;base64,R0lGODlhGAASAPcAAAAAAP%2f%2f%2fwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%0d%0aAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH5BAEAAP8ALAAAAAAYABIA%0d%0aAAhHAP8JHEiwoMGDCBMqXMiwocOHBQNInEiRokKJFwNc%2fKfxoMaOCDuCHChyo8CRIEcaLGmxZMKP%0d%0aITlmnPmyok2MEHPq3MlTYUAAOw%3d%3d" style="border-width:0px;"></a></span></div><div id="MSTWHidden" style="display: none;"><span id="MSTWCheckOut">Check out this page in {0} translated from {1}</span><span id="MSTWTranslatedFrom">translated from</span><span id="MSTWOriginal">Original:</span><span id="MSTWTranslated">Translated:</span><span id="MSTWPoweredBy">Automatic translation powered by Microsoft® Translator</span><span id="MSTWStart">Start translating</span><span id="MSTWStop">Stop translating</span><span id="MSTWClose">Close</span><span id="MSTWCloseShowOrig">Close and show original page</span><span id="MSTWLangNotSup"></span><span id="MSTWSelect">Select</span></div></div></div> <script type="text/javascript"> /* <![CDATA[ */ setTimeout(function() { var s = document.createElement("script"); s.type = "text/javascript"; s.charset = "UTF-8"; s.src = ((location && location.href && location.href.indexOf('https') == 0) ? "https://ssl.microsofttranslator.com" : "http://www.microsofttranslator.com" ) + "/ajax/v2/widget.aspx?mode=manual&from=en&layout=ts"; var p = document.getElementsByTagName('head')[0] || document.documentElement; p.insertBefore(s, p.firstChild); }, 0); /* ]]> */ </script> 
    <div style="float:right;" href="https://rise4fun.com/Z3/tutorial/guide" id="social"></div>
    <div class="coursebanner">
        Z3 - guide
        <a href="http://research.microsoft.com/">
            <img src="./Z3 - Guide_files/logo_msr_small.png" alt="Microsoft Research" width="82" height="23" class="logo">
        </a>
    </div>
    <div class="courselinks">
    
        <a class="link" href="https://rise4fun.com/z3/tutorialcontent/guide#courselist">other tutorials</a>        
        &nbsp;&nbsp;
    
        <a class="link" target="_parent" href="https://rise4fun.com/Z3">close</a>        
    </div>
    <div>
        


<h1>Getting Started with Z3: A Guide</h1><div class="toc"><ol class="toc"><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h20">Introduction</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h21">Basic Commands</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h22">Propositional Logic</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h23">Uninterpreted functions and constants</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h24">Arithmetic</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h25">Bitvectors</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h26">Arrays</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h27">Datatypes</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h28">Quantifiers</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h29">Conclusion</a></li><li><a href="https://rise4fun.com/z3/tutorialcontent/guide#h210">tutorials</a></li></ol></div><div class="clear"></div>
<p style="clear:both;">Be sure to follow along with the examples by clicking the "edit" link in the
corner. See what the tool says, try your own formulas, and experiment!</p>

<h2 id="h20">Introduction</h2>

<p>
Z3 is a state-of-the art theorem prover from Microsoft Research. It  
can be used to check the satisfiability of logical formulas over one or more theories. 
Z3 offers a compelling match for software analysis and verification tools, since several 
common software constructs map directly into supported theories.
</p>

<p>
The main objective of the tutorial is to introduce the reader on how to use
Z3 effectively for logical modeling and solving.
The tutorial provides some general background on logical modeling, 
but we have to defer a full introduction to first-order logic and 
decision procedures to text-books.
</p>

<p>
Z3 is a low level tool. It is best used
as a component in the context of other tools that require solving logical
formulas. Consequently, Z3 exposes a number of API facilities to make it 
convenient for tools to map into Z3, but there are no stand-alone 
editors or user-centric facilities for interacting with Z3. 
The language syntax used in the front ends favor simplicity in contrast
to linguistic convenience. 
</p>

<h2 id="h21">Basic Commands</h2>

<p>
The Z3 input format is an extension of the one defined by the 
<a href="http://www.smtlib.org/" target="_blank">SMT-LIB 2.0 standard</a>.
A Z3 script is a sequence of commands. 
The <b>help</b> command displays a list of all available
commands. The command <b>echo</b> displays a message. 
Internally, Z3 maintains a <b>stack</b>
of user provided formulas and declarations. 
We say these are the <b>assertions</b> provided by the user. 
The command <b>declare-const</b> declares a constant of a given type (aka sort). 
The command <b>declare-fun</b> declares a function. 
In the following example, we declared a function that
receives an integer and a boolean, and returns an integer.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/9qN?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">starting Z3...</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
The command <b>assert</b>
adds a formula into the Z3 internal stack. 
We say the set of formulas in the Z3 stack is <b>satisfiable</b>
if there is an interpretation (for the user declared constants and functions)
that makes all asserted formulas true.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/E?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">100</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre> 
<p>
The first asserted formula states that the constant <tt>a</tt> must be greater than 10.
The second one states that the function <tt>f</tt> applied to <tt>a</tt> and <tt>true</tt> must
return a value less than 100.
The command <b>check-sat</b> determines whether the current formulas on the Z3 stack
are satisfiable or not. 
If the formulas are satisfiable, Z3 returns <b>sat</b>. If they are not satisfiable (i.e., they are <b>unsatisfiable</b>),
Z3 returns <b>unsat</b>. Z3 may also return <b>unknown</b> when it can't determine whether a formula
is satisfiable or not.
</p>

<p> 
When the command check-sat returns <b>sat</b>, the command <b>get-model</b> can be used to retrieve 
an interpretation that makes all formulas on the Z3 internal stack true.
</p> 
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/E8?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">100</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre> 

<p>
The interpretation is provided using <b>definitions</b>. 
For example, the definition: </p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token delimiter square smt2 bracket-open">[</span><span class="token identifier smt2">val</span><span class="token delimiter square smt2 bracket-close">]</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
states that the value of <tt>a</tt> in the model is <tt>[val]</tt>.
The definition: </p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token source smt2">!</span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token source smt2">!</span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><br><span class="token white smt2">   </span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><br><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
is very similar to a function definition used in programming languages.
In this example, <tt>x1</tt> and <tt>x2</tt> are the arguments of the function interpretation
created by Z3. For this simple example, the definition of <tt>f</tt> is based on
<b>ite</b>'s (aka if-then-elses or conditional expressions). For example, the expression:
</p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">ite</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token source smt2">!</span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">11</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token source smt2">!</span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">21</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
evaluates (returns) 21 when <tt>x!1</tt> is equal to 11, and <tt>x!2</tt> is equal to false.
Otherwise, it returns 0.
</p>

<h3>Using Scopes</h3>

<p>
In some applications, we want to explore several similar problems that share several definitions and assertions.
We can use the commands <b>push</b> and <b>pop</b> for doing that. Z3 maintains a global stack of declarations
and assertions. The command <tt>push</tt> creates a new scope by saving the current stack size. 
The command <tt>pop</tt> removes any assertion or declaration performed between it and the matching push.
The <tt>check-sat</tt> and <tt>get-assertions</tt> commands always operate on the content of the global stack.
</p>

<p>In the following example, the command <tt>(assert p)</tt> signs an error because the <tt>pop</tt> command 
removed the declaration for <tt>p</tt>. If the last <tt>pop</tt> command is removed, then the error is corrected.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/j?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">push</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">20</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">pop</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; remove the two assertions</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">push</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">21</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">pop</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; error, since declaration of p was removed from the stack</span></span></pre>

<p>The <tt>push</tt> and <tt>pop</tt> commands can optionally receive
a numeral argument as specifed by the SMT 2 language.
</p>

<h3>Configuration</h3>

<p>The command <b>set-option</b> is used to configure Z3. Z3 has several options to control its behavior.
Some of these options (e.g., <tt>:produce-proofs</tt>) can only be set before any declaration or assertion.
We use the <b>reset</b> command to erase all assertions and declarations. After the <tt>reset</tt> command, all 
configuration options can be set.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/0nSM?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:print-success</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:produce-unsat-cores</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; enable generation of unsat cores</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:produce-models</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; enable model generation</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:produce-proofs</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; enable proof generation</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:produce-proofs</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; error, cannot change this option after a declaration or assertion</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">before reset</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">reset</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:produce-proofs</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; ok</span></span></pre>

<p>
The option <tt>:print-success true</tt> is particularly useful when Z3 is being controlled by another application using pipes.
In this mode, commands, that otherwise would not print any output, will print <tt>success</tt>.
</p>

<h3>Additional commands</h3>

<p>The command <b>(display t)</b> just applies the Z3 pretty printer to the given expression.
The command <b>(simplify t)</b> displays a possibly simpler expression equivalent to <tt>t</tt>.
This command accepts many different options, <tt>(help simplify)</tt> will display all available options.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/dy3?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token string identifier smt2">:som</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; put all expressions in sum-of-monomials form.</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token string identifier smt2">:arith-lhs</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">          </span><span class="token string identifier smt2">:sort-store</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">help</span><span class="token white smt2"> </span><span class="token keyword smt2">simplify</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The <b>define-sort</b> command defines a new sort symbol that is an abbreviation for a sort expression.
The new sort symbol can be parameterized, in which case the names of the parameters
are specified in the command and the sort expression uses the sort parameters. The form of the
command is this:
</p>

<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token delimiter square smt2 bracket-open">[</span><span class="token identifier smt2">symbol</span><span class="token delimiter square smt2 bracket-close">]</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter square smt2 bracket-open">[</span><span class="token identifier smt2">symbol</span><span class="token delimiter square smt2 bracket-close">]</span><span class="token predefined operator smt2">+</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter square smt2 bracket-open">[</span><span class="token identifier smt2">sort</span><span class="token delimiter square smt2 bracket-close">]</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The following example defines several abbreviations for sort expressions.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/0WB?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">T</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">IList</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">List-Set</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List</span><span class="token white smt2"> </span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">I</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">s1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token type identifier smt2">I</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List-Set</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">I</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l</span><span class="token white smt2"> </span><span class="token type identifier smt2">IList</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">s1</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token white smt2"> </span><span class="token identifier smt2">l</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h22">Propositional Logic</h2>

<p>
The pre-defined sort <bb>Bool</bb> is the sort (type) of all Boolean propositional expressions.
Z3 supports the usual Boolean operators <tt>and</tt>, <tt>or</tt>, <tt>xor</tt>, <tt>not</tt>, <tt>=&gt;</tt> (implication), <tt>ite</tt> (if-then-else).
Bi-implications are represented using equatity <tt>=</tt>.
The following example shows how to prove that if <tt>p</tt> implies <tt>q</tt> and <tt>q</tt> implies <tt>r</tt>, then <tt>p</tt> implies <tt>r</tt>.
We accomplish that by showing that the negation is unsatisfiable. The command <bb>define-fun</bb> is used to define a macro (aka alias). 
In this example, <tt>conjecture</tt> is an alias for the conjecture we want to prove.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/6v4?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">q</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">conjecture</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><br><span class="token white smt2">	</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">q</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">q</span><span class="token white smt2"> </span><span class="token identifier smt2">r</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">		</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">r</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token identifier smt2">conjecture</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Satisfiability and Validity</h3>

<p>A formula <tt>F</tt> is <b>valid</b> if <tt>F</tt> always evaluates to true for any assignment of appropriate values to its
uninterpreted function and constant symbols. 
A formula <tt>F</tt> is <b>satisfiable</b> if there is some assignment of appropriate values
to its uninterpreted function and constant symbols under which <tt>F</tt> evaluates to true. 
Validity is about finding a proof of a statement; satisfiability is about finding a solution to a set of constraints.
Consider a formula <tt>F</tt> with some uninterpreted constants, say <tt>a</tt> and <tt>b</tt>. 
We can ask whether <tt>F</tt> is valid, that is whether it is always true for any combination of values for 
<tt>a</tt> and <tt>b</tt>. If <tt>F</tt> is always
true, then <tt>not F</tt> is always false, and then <tt>not F</tt> will not have any satisfying assignment; that is, 
<tt>not F</tt> is unsatisfiable. That is, 
<tt>F</tt> is valid precisely when <tt>not F</tt> is not satisfiable (is unsatisfiable).
Alternately,
<tt>F</tt> is satisfiable if and only if <tt>not F</tt> is not valid (is invalid).
Z3 finds satisfying assignments (or report that there are none). To determine whether a
formula <tt>F</tt> is valid, we ask Z3 whether <tt>not F</tt> is satisfiable. 
Thus, to check the deMorgan's law is valid (i.e., to prove it), we show its negation to be unsatisfiable.</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/I?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">demorgan</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><br><span class="token white smt2">    </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">or</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token identifier smt2">demorgan</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h23">Uninterpreted functions and constants</h2>

<p>
The basic building blocks of SMT formulas are constants and  
functions. Constants are just functions that take no
arguments.
So everything is really just a function.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/e0?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; a is a constant</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; syntax sugar for (declare-fun b () Int)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">20</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
Unlike programming languages, where functions have side-effects, can throw exceptions, 
or never return, functions in classical first-order logic have no side-effects and are <b>total</b>.
That is, they are defined on all input values. This includes functions, such
as division.
</p>

<p>
Function and constant symbols in pure first-order logic are <i>uninterpreted</i> or <i>free</i>, 
which means that no a priori interpretation is attached.
This is in contrast to functions belonging to the signature of theories,
such as arithmetic where the function <tt>+</tt> has a fixed standard interpretation
(it adds two numbers). Uninterpreted functions and constants are maximally flexible;
they allow any interpretation that is consistent with the constraints over the function or constant.
</p>

<p>
To illustrate uninterpreted functions and constants let us introduce an (uninterpreted) sort
<tt>A</tt>, and the constants <tt>x</tt>, <tt>y</tt> ranging over <tt>A</tt>. Finally let <tt>f</tt>
be an uninterpreted function that takes one argument of sort <tt>A</tt> and results in a value
of sort <tt>A</tt>. The example illustrates how one can force an interpretation where <tt>f</tt>
applied twice to <tt>x</tt> results in <tt>x</tt> again, but <tt>f</tt> applied once to <tt>x</tt> is different form <tt>x</tt>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/L?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The resulting model introduces abstract values for the elements in <tt>A</tt>, because the sort <tt>A</tt>
is uninterpreted. The interpretation for <tt>f</tt> in the model toggles between the two values for <tt>x</tt>
and <tt>y</tt>, which are different. 
</p>

<h2 id="h24">Arithmetic</h2>

<p>
Z3 has builtin support for integer and real constants.
This two types should not be confused with machine integers (32-bit or 64-bit)
and floating point numbers. These two types (sorts) represent the mathematical
integers and reals. 
The command <b>declare-const</b> is used to declare integer and real constants.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/jw?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">d</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">e</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
After constants are declared, the user can assert.smt formulas containing these constants.
The formulas contain arithmetic operators such as: <tt>+</tt>, <tt>-</tt>, <tt>&lt;</tt>, and so on.
The command <b>check-sat</b> will instruct Z3 to try to find an interpretation for the declared constants
that makes all formulas true. The interpretation is basically assigning a number to each constant.
If such interpretation exists, we say it is a <b>model</b> for the asserted formulas. 
The command <b>get-model</b> displays the model built by Z3.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/E2?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">d</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">e</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">1000</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token identifier smt2">d</span><span class="token white smt2"> </span><span class="token identifier smt2">e</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
Real constants should contain a decimal point. Unlike
most programming languages, Z3 will not convert automatically integers into reals and
vice-versa. The function <b>to-real</b> can be used to convert an integer
expression into a real one.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/BwmK?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">d</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">e</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">e</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">to_real</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">2.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">d</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">to_real</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">0.5</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Nonlinear arithmetic</h3>

<p>
We say a formula is <b>nonlinear</b> if it contains expressions of the form
<b>(* t s)</b> where <tt>t</tt> and <tt>s</tt> are not numbers.
Nonlinear real arithmetic is very expensive, and Z3 is not complete for this kind of formula.
The command <b>check-sat</b> may return <b>unknown</b> or loop.
Nonlinear integer arithmetic is <b>undecidable</b>: there is no procedure
that is correct and terminates (for every input) with a <b>sat</b> or <b>unsat</b> answer.
Yes, it is <b>impossible</b> to build such procedure. Note that, this does not prevent
Z3 from returning an answer for many nonlinear problems. The real limit is that there will always be
a nonlinear integer arithmetic formula that it will fail produce an answer.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/S?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">Z3 does not always find solutions to non-linear problems</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">3.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">yet it can show unsatisfiabiltiy for some nontrivial nonlinear problems...</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number float smt2">2.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token number float smt2">1.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">1.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">reset</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">When presented only non-linear constraints over reals, Z3 uses a specialized complete solver</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">*</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">3.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Division</h3>

<p>
Z3 also has support for <b>division</b>, integer division, modulo and remainder operators.
Internally, they are all mapped to multiplication.  
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/0Msl?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r1</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r2</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r3</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r4</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r5</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">r6</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">div</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; integer division</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">mod</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; mod</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">rem</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; remainder</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r4</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">div</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; integer division</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r5</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">mod</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; mod</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">r6</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">rem</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; remainder</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">/</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token number float smt2">3.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token number float smt2">20.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
In Z3, <b>division by zero</b> is allowed,
but the result is not specified. Division is not a partial function. Actually, in Z3 all
functions are total, although the result may be underspecified in some cases like division by
zero.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/ajKV?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token comment smt2">; The following formula is satisfiable since division by zero is not specified.</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">/</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number float smt2">0.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">10.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token comment smt2">; Although division by zero is not specified, division is still a function.</span><br><span class="token comment smt2">; So, (/ a 0.0) cannot evaluated to 10.0 and 2.0.</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">/</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number float smt2">0.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">2.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
 If you are not happy with this behavior, you may use <b>ite</b> (if-then-else) operator to guard
every division, and assign whatever intepretation you like to the division by zero.
This example uses <b>define-fun</b> constructor to create a new operator: <b>mydiv</b>.
This is essentially a macro, and Z3 will expand its definition for every application of <b>mydiv</b>. 
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/m?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; defining my own division operator where x/0.0 == 0.0 for every x.</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">mydiv</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><br><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">if</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token number float smt2">0.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">      </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">/</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">      </span><span class="token number float smt2">0.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Real</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">mydiv</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number float smt2">1.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token number float smt2">0.0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h25">Bitvectors</h2>

<p>
Modern CPUs and main-stream programming languages use 
arithmetic over fixed-size bit-vectors.
The theory of bit-vectors allows modeling the 
precise semantics of unsigned and of 
signed two-complements arithmetic. There are a large number 
of supported functions and relations
over bit-vectors. They are summarized on Z3's 
<a href="http://research.microsoft.com/projects/z3/documentation.html" target="_blank">on-line documentation</a>
of the binary APIs and they are summarized on the <a href="http://www.smtlib.org/" target="_blank">SMT-LIB</a> web-site.
We will not try to give a comprehensive overview here, 
but touch on some of the main features.
</p>

<p>
In contrast to programming languages, such as C, C++, C#, Java, 
there is no distinction between signed and unsigned bit-vectors
as numbers. Instead, the theory of bit-vectors provides special signed versions of arithmetical operations
where it makes a difference whether the bit-vector is treated as signed or unsigned.
</p>

<p>
Z3 supports Bitvectors of arbitrary size. <tt>(_ BitVec n)</tt> is the sort of bitvectors
whose length is <tt>n</tt>. Bitvector literals may be defined using binary, decimal and hexadecimal notation.
In the binary and hexadecimal cases, the bitvector size is inferred from the number of characters.
For example, the bitvector literal <tt>#b010</tt> in binary format is a bitvector of size 3,
and the bitvector literal <tt>#x0a0</tt> in hexadecimal format is a bitvector of size 12.
The size must be specified for bitvector literals in decimal format. For example,
<tt>(_ bv10 32)</tt> is a bitvector of size 32 that representes the numeral <tt>10</tt>.
By default, Z3 display bitvectors in hexadecimal format if the bitvector size is a multiple of 4, and in binary otherwise. 
The command <tt>(set-option :pp.bv-literals false)</tt> can be used to force Z3 to display bitvector literals in
decimal format.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/8dj7?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">b0100</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token identifier smt2">bv20</span><span class="token white smt2"> </span><span class="token number smt2">8</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token identifier smt2">bv20</span><span class="token white smt2"> </span><span class="token number smt2">7</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:pp.bv-literals</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">b0100</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token identifier smt2">bv20</span><span class="token white smt2"> </span><span class="token number smt2">8</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token identifier smt2">bv20</span><span class="token white smt2"> </span><span class="token number smt2">7</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">display</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Basic Bitvector Arithmetic</h3>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/Y?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvadd</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; addition</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsub</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; subtraction</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvneg</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; unary minus</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvmul</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; multiplication</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvurem</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; unsigned remainder</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsrem</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; signed remainder</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsmod</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; signed modulo</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvshl</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x07</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; shift left</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvlshr</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; unsigned (logical) shift right</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvashr</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x03</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; signed (arithmetical) shift right</span></span></pre>

<h3>Bitwise Operations</h3>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/6ehA?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvor</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">   </span><span class="token comment smt2">; bitwise or</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvand</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; bitwise and</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnot</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; bitwise not</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnand</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; bitwise nand</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnor</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; bitwise nor</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvxnor</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x6</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; bitwise xnor</span></span></pre>

<p>
We can prove a bitwise version of deMorgan's law:
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/x?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">64</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">64</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvand</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnot</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnot</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvnot</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvor</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
Let us illustrate a simple property of bit-wise arithmetic.
There is a fast way to check that fixed size numbers are powers of
two. It turns out that a bit-vector <tt>x</tt> is a power of two or 
zero if and only if <tt>x &amp; (x - 1)</tt> is zero, where <tt>&amp;</tt> represents the bitwise and.
We check this for four bits below.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/G?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">is-power-of-two</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token white smt2"> </span><br><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvand</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsub</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><br><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">is-power-of-two</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">         </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">or</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">             </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x8</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Predicates over Bitvectors</h3>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/r?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvule</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; unsigned less or equal</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvult</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; unsigned less than</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvuge</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; unsigned greater or equal</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvugt</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; unsigned greater than</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsle</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; signed less or equal</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvslt</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; signed less than</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsge</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; signed greater or equal</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">simplify</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsgt</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x0a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">xf0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2">  </span><span class="token comment smt2">; signed greater than</span></span></pre>

<p>Signed comparison, such as <tt>bvsle</tt>, takes the sign bit of bitvectors into account for comparison,
while unsigned comparison treats the bitvector as unsigned (treats the bitvector as a natural number).
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/sl?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvule</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvsle</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h26">Arrays</h2>

<p>As part of formulating a programme of a mathematical theory of computation
McCarthy proposed a <i>basic</i> theory of arrays as characterized by
the select-store axioms. The expression <tt>(select a i)</tt> returns
the value stored at position <tt>i</tt> of the array <tt>a</tt>;
and <tt>(store a i v)</tt> returns a new array identical to <tt>a</tt>,
but on position <tt>i</tt> it contains the value <tt>v</tt>.
</p>

<p>
Z3 contains a decision procedure for the basic theory of
arrays. By default, Z3 assumes that arrays are
extensional over select. In other words, Z3 also enforces that if two 
arrays agree on all reads, then the arrays are equal.
</p>

<p>
It also contains various extensions 
for operations on arrays that remain decidable and amenable
to efficient saturation procedures (here efficient means, 
with an NP-complete satisfiability complexity).
We describe these extensions in the following using a collection of examples.
Additional background on these extensions is available in the 
paper <a href="http://research.microsoft.com/en-us/um/people/leonardo/fmcad09.pdf" target="_blank">Generalized and Efficient Array Decision Procedures</a>.
</p>

<h3>Select and Store</h3>

<p>Let us first check a basic property of arrays.
Suppose <tt>a1</tt> is an array of integers, then the constraint
<tt>(and (= (select a1 x) x) (= (store a1 x y) a1))</tt>
is satisfiable for an array that contains an index <tt>x</tt> that maps to <tt>x</tt>,
and when <tt>x = y</tt> (because the first equality forced the range of <tt>x</tt> to be <tt>x</tt>).
We can check this constraint.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/iO?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>On the other hand, the constraints become unsatisfiable when asserting
<tt>(not (= x y))</tt>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/9oKM?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">store</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Constant Arrays</h3>

<p>
The array that maps all indices to some fixed value can be specified in Z3 using the
<tt>const</tt> construct. It takes one value from the range type of
the array and creates an array. Z3 cannot infer what kind of array must be returned
by the <tt>const</tt> construct by just inspecting the argument type.
Thus, a qualified identifier <tt>(as const (Array T1 T2))</tt> must be used.
The following example defines a constant array containing only ones.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/Ii?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">all1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">i</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">all1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">as</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">const</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">all1</span><span class="token white smt2"> </span><span class="token identifier smt2">i</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Array models</h3>

<p>
Models provide interpretations of the uninterpreted (aka free) constants  and functions that appear in the satisfiable formula. 
An interpretation for arrays is very similar to the interpretation of a function.
Z3 uses the construct <tt>(_ as-array f)</tt> to give the interpretation for arrays.
If the array <tt>a</tt> is equal to <tt>(_ as-array f)</tt>, then for every index <tt>i</tt>, 
<tt>(select a i)</tt> is equal to <tt>(f i)</tt>.
In the previous example, Z3 creates the auxiliary function <tt>k!0</tt> to assign an interpretation to the array constant <tt>all1</tt>.
</p>

<h3>Mapping Functions on Arrays</h3>

<p>
In the following, we will simulate basic Boolean algebra
(set theory) using the array theory extensions in Z3.
Z3 provides a parametrized <tt>map</tt> function on arrays. 
It allows applying arbitrary functions to the range of arrays.
The following example illustrates how to use the <tt>map</tt> function.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/slc?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">T</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Set</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">push</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">and</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">not</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">or</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">not</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">not</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">pop</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">push</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">and</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">pop</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">push</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">or</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Bags as Arrays</h3>

<p>
We can use the parametrized map function to encode
finite sets and finite bags. Finite bags can be modeled similarly to sets.
A bag is here an array that maps elements to their multiplicity. 
Main bag operations include <tt>union</tt>, obtained by adding multiplicity, 
<tt>intersection</tt>, by taking the minimum multiplicity, and a dual <tt>join</tt>
operation that takes the maximum multiplicity. In the following example,
we define the bag-union using <tt>map</tt>. Notice that we need
to specify the full signature of <tt>+</tt> since it is an overloaded operator.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/rN?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Array</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">bag-union</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><br><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">map</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">s1</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">s3</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">s3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">bag-union</span><span class="token white smt2"> </span><span class="token identifier smt2">s1</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">s1</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">5</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">select</span><span class="token white smt2"> </span><span class="token identifier smt2">s2</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">4</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h27">Datatypes</h2>

<p>
Algebraic datatypes, known from programming languages such as ML, offer a convenient
way for specifying common data structures. Records and tuples are special cases of
algebraic datatypes, and so are scalars (enumeration types). But algebraic datatypes are
more general. They can be used to specify finite lists, trees and other
recursive structures. 
</p>

<h3>Records</h3>

<p>A record is specified as a datatype with a single constructor and as many arguments
as record elements. The number of arguments to a record are always the same. 
The type system does not allow to extend records and there is no record subtyping. 
</p>

<p>
The following example illustrates that two records are equal only if all the arguments are equal. 
It introduces the parametric type <tt>Pair</tt>, with constructor <tt>mk-pair</tt>
and two arguments that can be accessed using the selector functions <tt>first</tt> and <tt>second</tt>.
</p>
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/LA?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-datatypes</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T1</span><span class="token white smt2"> </span><span class="token type identifier smt2">T2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Pair</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">mk-pair</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">first</span><span class="token white smt2"> </span><span class="token type identifier smt2">T1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">second</span><span class="token white smt2"> </span><span class="token type identifier smt2">T2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">p1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Pair</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">p2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Pair</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">p1</span><span class="token white smt2"> </span><span class="token identifier smt2">p2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">second</span><span class="token white smt2"> </span><span class="token identifier smt2">p1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">20</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">first</span><span class="token white smt2"> </span><span class="token identifier smt2">p1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">first</span><span class="token white smt2"> </span><span class="token identifier smt2">p2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Scalars (enumeration types)</h3>

<p>A scalar sort is a finite domain sort. The elements of the finite domain are enumerated
as distinct constants. For example, the sort <tt>S</tt> is a scalar type with
three values <tt>A</tt>, <tt>B</tt> and <tt>C</tt>. It is possible for three constants
of sort <tt>S</tt> to be distinct, but not for four constants.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/IA?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-datatypes</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">S</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token white smt2"> </span><span class="token type identifier smt2">C</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">S</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">S</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">S</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">u</span><span class="token white smt2"> </span><span class="token type identifier smt2">S</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">distinct</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">distinct</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token identifier smt2">u</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Recursive datatypes</h3>

<p>
A recursive datatype declaration includes itself directly (or indirectly) as a component.
A standard example of a recursive data-type is the one of lists. A parametric list
can be specified in Z3 as:
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/775?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-datatypes</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Lst</span><span class="token white smt2"> </span><span class="token identifier smt2">nil</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">cons</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">hd</span><span class="token white smt2"> </span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">tl</span><span class="token white smt2"> </span><span class="token type identifier smt2">Lst</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Lst</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Lst</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>The <tt>List</tt> recursive datatype is builtin in Z3.
The empty list is <tt>nil</tt>, and the constructor <tt>insert</tt> is used to build new lists.
The accessors <tt>head</tt> and <tt>tail</tt> are defined as usual.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/p?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">l3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">List</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token white smt2"> </span><span class="token identifier smt2">nil</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token white smt2"> </span><span class="token identifier smt2">nil</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">head</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">head</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">l3</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">insert</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">100</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">tail</span><span class="token white smt2"> </span><span class="token identifier smt2">l1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">tail</span><span class="token white smt2"> </span><span class="token identifier smt2">l2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>In the example above, we also assert that <tt>l1</tt> and <tt>l2</tt> are not <tt>nil</tt>. 
This is because the interpretation
of <tt>head</tt> and <tt>tail</tt> is underspecified on <tt>nil</tt>. So then 
head and tail would not be able to distinguish 
<tt>nil</tt> from <tt>(insert (head nil) (tail nil))</tt>.
</p>

<h3>Mutually recursive datatypes</h3>

<p>
You can also specify mutually recursive datatypes for Z3.
We list one example below.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/eV?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; declare a mutually recursive parametric datatype</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-datatypes</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Tree</span><span class="token white smt2"> </span><span class="token identifier smt2">leaf</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">node</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">value</span><span class="token white smt2"> </span><span class="token type identifier smt2">T</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">children</span><span class="token white smt2"> </span><span class="token type identifier smt2">TreeList</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                        </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">TreeList</span><span class="token white smt2"> </span><span class="token identifier smt2">nil</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">cons</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">car</span><span class="token white smt2"> </span><span class="token type identifier smt2">Tree</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">cdr</span><span class="token white smt2"> </span><span class="token type identifier smt2">TreeList</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">t1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Tree</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">t2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Tree</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token comment smt2">; we must use the 'as' construct to distinguish the leaf (Tree Int) from leaf (Tree Bool)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">t1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">as</span><span class="token white smt2"> </span><span class="token identifier smt2">leaf</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Tree</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">value</span><span class="token white smt2"> </span><span class="token identifier smt2">t1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">20</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">is-leaf</span><span class="token white smt2"> </span><span class="token identifier smt2">t2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">value</span><span class="token white smt2"> </span><span class="token identifier smt2">t2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>In the example above, we have a tree of Booleans and a tree of integers. The <tt>leaf</tt>
constant must return a tree of a specific sort. To specify the result sort, we use the qualified 
identifier <tt>(as leaf (Tree Int))</tt>. Note that, we do not need to use a qualified identifer
for <tt>value</tt>, since Z3 can infer the intended declaration using the sort of the argument.
</p>

<h3>Z3 will not prove inductive facts</h3>

<p>
The ground decision procedures for recursive datatypes don't lift
to establishing inductive facts. Z3 does not contain methods
for producing proofs by induction. This may change in the future.
In particular, consider
the following example where the function <tt>p</tt> is true
on all natural numbers, which can be proved by induction over
<tt>Nat</tt>. Z3 enters a matching loop as it attempts instantiating
the universally quantified implication. 
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/dRWWo?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:timeout</span><span class="token white smt2"> </span><span class="token number smt2">2000</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-datatypes</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Nat</span><span class="token white smt2"> </span><span class="token identifier smt2">zero</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">succ</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">pred</span><span class="token white smt2"> </span><span class="token type identifier smt2">Nat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Nat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">zero</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Nat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">implies</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">pred</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Nat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-info</span><span class="token white smt2"> </span><span class="token string identifier smt2">:all-statistics</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h2 id="h28">Quantifiers</h2>

<p>
Z3 is a <i>decision procedure</i>
for the combination of the previous quantifier-free theories.
That is, it can answer whether a quantifier-free formula, modulo
the theories referenced by the formula, is satisfiable or whether
it is unsatisfiable. Z3 also accepts and can work with formulas
that use quantifiers. It is no longer a decision procedure for 
such formulas in general (and for good reasons, as there can be
no decision procedure for first-order logic).
</p>

<p>
Nevertheless, Z3 is often able to handle formulas involving
quantifiers. It uses several approaches to handle quantifiers.
The most prolific approach is using <i>pattern-based</i> quantifier
instantiation. This approach allows instantiating quantified formulas
with ground terms that appear in the current search context based
on <i>pattern annotations</i> on quantifiers. Another approach
is based on <i>saturation theorem proving</i> using a superposition
calculus which is a modern method for applying resolution style 
rules with equalities.
The pattern-based instantiation method is quite effective, 
even though it is inherently incomplete. The saturation based approach
is complete for pure first-order formulas, but does not scale as 
nicely and is harder to predict.
</p>

<p>
Z3 also contains a model-based quantifier instantiation 
component that uses a model construction to find good terms to instantiate
quantifiers with; and Z3 also handles many decidable fragments.
</p>

<h3>Modeling with Quantifiers</h3>

<p>
Suppose we want to model an object oriented type system with 
single inheritance. We would need a predicate for sub-typing.
Sub-typing should be a partial order, and respect single inheritance.
For some built-in type constructors, such as for <tt>array-of</tt>, sub-typing
should be monotone. 
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/pl?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Type</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">array-of</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">          </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">              </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">          </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">              </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">          </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">              </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">or</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">z</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">          </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">              </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">array-of</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">array-of</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">root-type</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">root-type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>Patterns</h3>

<p>
The Stanford Pascal verifier and the subsequent 
Simplify theorem prover 
pioneered the use of 
pattern-based quantifier instantiation. 
The basic idea behind pattern-based quantifier
instantiation is in a sense straight-forward:
Annotate a quantified formula using a <i>pattern</i> that contains
all the bound variables. 
So a pattern is an expression (that does not contain binding operations,
such as quantifiers) that contains variables bound by a 
quantifier.
Then instantiate the quantifier
whenever a term that matches the pattern is created during search.
This is a conceptually easy starting point, but there are several subtleties
that are important. 
</p>

<p>In the following example, 
the first two options make sure that Model-based quantifier instantiation and saturation engines are disabled.
We also annotate the quantified formula with the pattern <tt>(f (g x))</tt>.
Since there is no ground instance of this pattern, the quantifier is not instantiated, and Z3 fails to show that
the formula is unsatisfiable.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/K?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.auto-config</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable automatic self configuration</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable model-based quantifier instantiation</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
 
<p>When the more permissive pattern <tt>(g x)</tt> is used. Z3 proves the formula to be unsatisfiable.
More restrive patterns minimize the number of instantiations (and potentially improve performance), but
they may also make Z3 "less complete". 
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/2DWu?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.auto-config</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable automatic self configuration</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable model-based quantifier instantiation</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
Some patterns may also create long instantiation chains.
Consider the following assertion.
</p>

<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">Type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">array-of</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">array-of</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">     </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The axiom gets instantiated whenever there is some 
ground term of the form <tt>(subtype s t)</tt>. 
The instantiation causes a fresh ground term
<tt>(subtype (array-of s) (array-of t))</tt>, which enables a new instantiation. 
This undesirable situation is called a <b>matching loop</b>.
Z3 uses many heuristics to break matching loops.
</p>

<p>
Before elaborating on the subtleties, we should address an important first question.
What defines the terms that are created during search?
In the context of most SMT solvers, and of the Simplify theorem prover,
terms exist as part of the input formula, they are of course also created 
by instantiating quantifiers, but terms are also implicitly created when 
equalities are asserted. 
The last point means that terms are considered up to congruence and
pattern matching takes place modulo ground equalities. We call the
matching problem <b>E-matching</b>.
For example, if we have the following equalities:
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/pO?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.auto-config</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable automatic self configuration</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">false</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token comment smt2">; disable model-based quantifier instantiation</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The terms <tt>(f a)</tt> and <tt>(f (g b))</tt> are equal modulo the equalities.
The pattern <tt>(f (g x))</tt> can be matched and <tt>x</tt> bound to <tt>b</tt>
(and the equality <tt>(= (f (g b)) b)</tt> is deduced.
</p>

<p>
While E-matching is an NP-complete problem, the main sources of overhead 
in larger verification problems comes
from matching thousands of patterns in the context of an evolving set
of terms and equalities. Z3 integrates an efficient E-matching engine
using term indexing techniques.
</p>

<h3>Multi-patterns</h3>

<p>In some cases, there is no pattern that contains all bound variables and does not contain interpreted symbols.
In these cases, we use multi-patterns.
In the following example, the quantified formula states that <tt>f</tt> is injective.
This quantified formula is annotated with the multi-pattern <tt>(f x) (f y)</tt>
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/5bH?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">y</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">y</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The quantified formula  is instantiated for every pair of occurrences of <tt>f</tt>.
A simple trick allows formulating injectivity of <tt>f</tt> in such a way that only a linear number
of instantiations is required. The trick is to realize that <tt>f</tt> is injective if and only if
it has a partial inverse. 
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/F?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f-inv</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token source smt2">!</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f-inv</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token string identifier smt2">:pattern</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                   </span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token white smt2"> </span><span class="token type identifier smt2">A</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">B</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h3>No patterns</h3>

<p>
The annotation <tt>:no-pattern</tt> can be used to instrument Z3 
not to use a certain sub-expression as a pattern.
The pattern inference engine may otherwise choose arbitrary sub-expressions
as patterns to direct quantifier instantiation. 
</p>

<h3>Model-based Quantifier Instantiation</h3>

<p>
The model-based quantifier instantiation (MBQI)  is essentially a
counter-example based refinement loop, where candidate models are
built and checked. When the model checking step fails, it creates new
quantifier instantiations. The models are returned as simple
functional programs. In the following example, the model provides an interpretation
for function <tt>f</tt> and constants <tt>a</tt> and <tt>b</tt>. One can easily check that the
returned model does indeed satisfy the quantifier.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/YS?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">echo</span><span class="token white smt2"> </span><span class="token string quote smt2 bracket-open">"</span><span class="token string smt2">evaluating (f (+ a 10) 20)...</span><span class="token string quote smt2 bracket-close">"</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">eval</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">20</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<p>
The command <tt>eval</tt>
evaluates an expression in the last model produced by Z3. It is essentially
executing the "function program" produced by Z3.
</p>

<p>
MBQI is a decision procedure for several useful fragments.
It may find models even for formulas that are not in any of these fragments.
We describe some of these fragments.
</p>

<h4>Effectively Propositional</h4>

<p>
The <b>effectively propositional</b> class of formulas (aka The Bernays-Schonfinkel class)
is a decidable fragment of first-order logic formulas. It corresponds to formulas which, 
when written in prenex normal form contain only constants, universal quantifiers, and
functions that return boolean values (aka predicates).
</p>
<p>
Problems arising from program verification often involve establishing facts of
quantifier-free formulas, but the facts themselves use relations and functions that are conveniently axiomatized
using a background theory that uses quantified formulas. One set of examples of this situation
comprise of formulas involving partial-orders. The following example axiomatizes a <tt>subtype</tt>
partial order relation that has the <b>tree property</b>. That is, if <tt>x</tt> and <tt>y</tt> are subtypes
of <tt>z</tt>, then <tt>x</tt> is a subtype of <tt>y</tt> or <tt>y</tt> is a subtype of <tt>x</tt>.
The option <tt>(set-option :model.compact true)</tt> instructs Z3 to eliminate trivial redundancies from the
generated model. In this example, Z3 also creates a finite interpretation for the uninterpreted sort <tt>T</tt>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/cF02?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example</span></span></pre>

<p>
Note that it uses two auxiliary functions (<tt>subtype!25</tt> and <tt>k!24</tt>) that were not
part of your formula. They are auxiliary definitions created by Z3 during the model construction procedure.
We can also ask "questions" by using the <tt>eval</tt> command. For example,
</p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">eval</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">subtype</span><span class="token white smt2"> </span><span class="token identifier smt2">int-type</span><span class="token white smt2"> </span><span class="token identifier smt2">complex-type</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
executes (evaluates) the given expression using the produced functional program (model).
</p>
<p>
Constraints over sets (Boolean Algebras) can be encoded into this
fragment by treating sets as unary predicates and lifting equalities
between sets as formula equivalence. 
</p><p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/YR?frame=1&amp;menu=0&amp;course=1">load in editor</a></p><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example</span></span></pre>

<h4>Stratified Sorts Fragment</h4>

<p>The <b>statified sorts fragment</b> is another decidable fragment of
many sorted first-order logic formulas. It corresponds to formulas which, 
when written in prenex normal form, 
there is a function <tt>level</tt> from sorts to naturals,
and for every function </p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">S_1</span><span class="token white smt2"> </span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><span class="token white smt2"> </span><span class="token type identifier smt2">S_n</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">R</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p>
<tt>level(R) &lt; level(S_i)</tt>. 
</p>

<h4>Array Property Fragment</h4>

<p>The <b>array property fragment</b> can encode properties about unidimensional, and is
strong enough to say an array is sorted. More information about this fragment can be
found in the paper <a href="http://academic.research.microsoft.com/Paper/1843442.aspx" target="_blank">What's Decidable About Arrays?</a>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/H?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example</span></span></pre>

<h4>List Fragment</h4>

<p>The <b>list fragment</b> can encode properties about data-structures such as lists.
For each quantified axiom <tt>q</tt> in this fragment, there is an "easy" way to satisfy <tt>q</tt>.
More information about this fragment can be
found in the paper <a href="http://www.cs.berkeley.edu/~necula/Papers/verifier-cav05.pdf" target="_blank">
Data Structure Specifications
via Local Equality Axioms</a>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/4Oplu?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example</span></span></pre>

<h4>Essentially (Almost) Uninterpreted Fragment</h4>

<p>The essentially/almost uninterpreted fragment subsumes the previous fragments, and uses
a more relaxed notion of stratification. 
More information about this fragment can be
found in the paper <a href="http://research.microsoft.com/en-us/um/people/leonardo/ci.pdf" target="_blank">
Complete instantiation for quantified formulas in
Satisfiabiliby Modulo Theories.
</a> The model based quantifier instantiation approach used in Z3 is also described in this paper.
Stratified data-structures (such as arrays of pointers) can be encoded in this fragment. </p>
 
<a class="listinglink" target="default" href="https://rise4fun.com/Z3/W?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example.</span></span></pre>

<p>
Shifts on streams (or arrays) can also be encoded.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/5Lb?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token comment smt2">;; f an g are "streams"</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token comment smt2">;; the segment [a, n + a] of stream f is equal</span><br><span class="token comment smt2">;; to the segment [0, n] of stream g.</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">n</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;=</span><span class="token white smt2"> </span><span class="token number smt2">0</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">n</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token white smt2">                              </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token comment smt2">;; adding some constraints to a</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token number smt2">2</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&lt;=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">g</span><span class="token white smt2"> </span><span class="token number smt2">3</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token number smt2">10</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h4>Quantified Bit-Vector Formulas</h4>

<p>
A <b>quantified bit-Vector formula</b> (QBVF) is a many sorted
first-order logic formula where the sort of every variable is a
bit-vector sort.  The QBVF satisfiability problem, is the problem of
deciding whether a QBVF is satisfiable modulo the theory of
bit-vectors. This problem is decidable because every universal
(existental) quantifier can be expanded into a conjunction
(disjunction) of potentially exponential, but finite size. 
A distinguishing feature in QBVF is the support for uninterpreted
function and predicate symbols. More information about this fragment
can be found in the paper 
<a href="http://research.microsoft.com/en-us/um/people/leonardo/fmcad10.pdf" target="_blank">
Efficiently Solving Quantified Bit-Vector Formulas</a>.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/4TZ7?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">define-sort</span><span class="token white smt2"> </span><span class="token type identifier smt2">Char</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">_</span><span class="token white smt2"> </span><span class="token type identifier smt2">BitVec</span><span class="token white smt2"> </span><span class="token number smt2">8</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2">  </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvugt</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x00</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f1</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvadd</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x01</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x00</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Char</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">or</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">bvadd</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token operator smt2">#</span><span class="token identifier smt2">x01</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f1</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h4>Conditional (and Pseudo) Macros</h4>

<p> Quantifiers defining "macros" are also automatically detected by the Model Finder.
In the following example, the first three quantifiers are defining <tt>f</tt> by cases.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/G5?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.mbqi</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-fun</span><span class="token white smt2"> </span><span class="token identifier smt2">p2</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token type identifier smt2">Bool</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">declare-const</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">+</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">and</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined identifier smt2">not</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p2</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token type identifier smt2">Int</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><br><span class="token white smt2">                </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p2</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">-</span><span class="token white smt2"> </span><span class="token identifier smt2">x</span><span class="token white smt2"> </span><span class="token number smt2">1</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p</span><span class="token white smt2"> </span><span class="token identifier smt2">c</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">p2</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">assert</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token predefined operator smt2">&gt;</span><span class="token white smt2"> </span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">f</span><span class="token white smt2"> </span><span class="token identifier smt2">a</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token identifier smt2">b</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">check-sat</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><br><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">get-model</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>

<h4>My formula is not in any of the fragments above</h4>

<p>
Even if your formula is not in any of the fragments above.
Z3 may still find a model for it. For example, 
The following simple example is not in the fragments described above.
</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/v?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example.</span></span></pre>

<p>
The Z3 preprocessor has many options that may improve the performace of the model
finder. In the following example, <tt>:macro-finder</tt> will expand quantifiers representing macros
at preprocessing time.</p> 

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/yl?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example.</span></span></pre>

<p>It is very effective in this benchmark since it contains many
quantifiers of the form
</p>
<pre class="listing"><span class="monaco-editor vs"><span class="token keyword smt2">forall</span><span class="token white smt2"> </span><span class="token identifier smt2">x.</span><span class="token white smt2">  </span><span class="token identifier smt2">p</span><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token identifier smt2">x</span><span class="token delimiter parenthesis smt2 bracket-close">)</span><span class="token white smt2"> </span><span class="token predefined operator smt2">=</span><span class="token white smt2"> </span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span><span class="token delimiter smt2">.</span></span></pre>

<p>
The Z3 model finder is more effective if the input formula does not contain nested quantifiers.
If that is not the case for your formula, you can use the option</p>
<pre class="listing"><span class="monaco-editor vs"><span class="token delimiter parenthesis smt2 bracket-open">(</span><span class="token keyword smt2">set-option</span><span class="token white smt2"> </span><span class="token string identifier smt2">:smt.pull-nested-quantifiers</span><span class="token white smt2"> </span><span class="token predefined identifier smt2">true</span><span class="token delimiter parenthesis smt2 bracket-close">)</span></span></pre>
<p> 
The following challenge problem from the paper <a href="http://academic.research.microsoft.com/Paper/615910.aspx" target="_blank">
SEM: a system for enumerating models</a> is proved to be unsatisfiable in less than one second by Z3.</p>

<a class="listinglink" target="default" href="https://rise4fun.com/Z3/WH?frame=1&amp;menu=0&amp;course=1">load in editor</a><pre class="listing"><span class="monaco-editor vs"><span class="token comment smt2">; click on edit to see the example.</span></span></pre>

<h2 id="h29">Conclusion</h2>

<p>
Z3 is an efficient theorem prover used in many software testing, analysis and verification applications.
In this tutorial, we covered its main capabilities using the textual interface.
However, most applications use the Z3 programmatic 
<a href="http://research.microsoft.com/en-us/um/redmond/projects/z3/documentation.html" target="_blank">API</a>
to access these features.
</p>

    
    </div>
    
    <div id="courselist">
        <h2 id="h210">tutorials</h2>
        <div class="toc">
        <ul>
            
                <li><a href="https://rise4fun.com/Z3/tutorial/strategies" target="_parent">strategies</a></li>
                <li><a href="https://rise4fun.com/Z3/tutorial/fixedpoints" target="_parent">fixedpoints</a></li>
                <li><a href="https://rise4fun.com/Z3/tutorial/sequences" target="_parent">sequences</a></li>
                <li><a href="https://rise4fun.com/Z3/tutorial/optimization" target="_parent">optimization</a></li>
                <li><a href="https://rise4fun.com/Z3/tutorial/guide" target="_parent">guide</a></li>
        </ul></div>
    </div>
    
    <div class="copy">
        <a target="_blank" href="https://go.microsoft.com/?linkid=2028325">Contact Us</a>| <a target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy &amp; Cookies</a> | <a target="_blank" href="https://go.microsoft.com/fwlink/?LinkID=246338">Terms of Use</a> | <a target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=506942">Trademarks</a>| © 2019 Microsoft
    </div>
    <div class="logos">
    <a href="http://research.microsoft.com/">
        <img src="./Z3 - Guide_files/logo_msr.png" alt="Microsoft Research" width="143" height="41" class="logo">
    </a>    
    </div>
    <div id="progressbar" style="background-color: purple; position: absolute; top: 0px; color: white; width: 300px; left: 0px; font-size: small; padding: 8px; display: none;">loading...</div>
    <script src="./Z3 - Guide_files/MathJax.js" id=""></script>
    <script type="text/javascript" src="./Z3 - Guide_files/analytics.js"></script>
<script type="text/javascript" src="./Z3 - Guide_files/mscc-0.3.6.min.js"></script>
</body></html>